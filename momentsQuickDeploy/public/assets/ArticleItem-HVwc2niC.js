import{h as C,c as n,a as e,o as s,f as $,s as D,t as h,m as o,k as c,C as N,I as _,w as f,b as p,D as V,_ as A,g as b,p as q,F as R,l as B,E as S,G as T,d as E,A as j,n as L,i as z,j as P}from"./index-DC8TisQv.js";import{s as O,a as F}from"./time-Pdvgg59k.js";import{T as U,A as G,g as J}from"./location-Bpxr3BpU.js";const K={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Q=C({name:"CommentAltRegular",render:function(y,a){return s(),n("svg",K,a[0]||(a[0]=[e("path",{d:"M448 0H64C28.7 0 0 28.7 0 64v288c0 35.3 28.7 64 64 64h96v84c0 7.1 5.8 12 12 12c2.4 0 4.9-.7 7.1-2.4L304 416h144c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64zm16 352c0 8.8-7.2 16-16 16H288l-12.8 9.6L208 428v-60H64c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16h384c8.8 0 16 7.2 16 16v288z",fill:"currentColor"},null,-1)]))}}),W={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},X=C({name:"Heart",render:function(y,a){return s(),n("svg",W,a[0]||(a[0]=[e("path",{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z",fill:"currentColor"},null,-1)]))}}),Y={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},H=C({name:"HeartRegular",render:function(y,a){return s(),n("svg",Y,a[0]||(a[0]=[e("path",{d:"M458.4 64.3C400.6 15.7 311.3 23 256 79.3C200.7 23 111.4 15.6 53.6 64.3C-21.6 127.6-10.6 230.8 43 285.5l175.4 178.7c10 10.2 23.4 15.9 37.6 15.9c14.3 0 27.6-5.6 37.6-15.8L469 285.6c53.5-54.7 64.7-157.9-10.6-221.3zm-23.6 187.5L259.4 430.5c-2.4 2.4-4.4 2.4-6.8 0L77.2 251.8c-36.5-37.2-43.9-107.6 7.3-150.7c38.9-32.7 98.9-27.8 136.5 10.5l35 35.7l35-35.7c37.8-38.5 97.8-43.2 136.5-10.6c51.1 43.1 43.5 113.9 7.3 150.8z",fill:"currentColor"},null,-1)]))}}),Z={class:"timeAndAction"},ee={key:0,class:"popup"},te=C({__name:"ArticleActions",props:{article:{type:Object,required:!0}},emits:["like","comment"],setup(i,{emit:y}){const a=i,l=$(!1),v=$(!1);function k(){v.value=!v.value}const d=y,t=D(()=>{const m=new Date(a.article.created_at);return isNaN(m.getTime())?0:m.getTime()});return(m,u)=>(s(),n("div",Z,[e("p",{onClick:u[0]||(u[0]=w=>l.value=!l.value)},h(l.value?o(O)(t.value):o(F)(t.value)),1),e("div",{class:"action-wrapper",onClick:k},[u[6]||(u[6]=e("div",{class:"dots-button"},[e("p"),e("p")],-1)),v.value?(s(),n("div",ee,[e("div",{class:"popup-item like",onClick:u[1]||(u[1]=w=>d("like"))},[i.article.isLiked?(s(),N(o(_),{key:1,color:"rgb(255,100,100)"},{default:f(()=>[p(o(X))]),_:1})):(s(),N(o(_),{key:0},{default:f(()=>[p(o(H))]),_:1})),e("span",null,h(i.article.isLiked?"取消喜欢":"喜欢"),1)]),u[5]||(u[5]=e("div",{class:"popup-divider"},null,-1)),e("div",{class:"popup-item comment",onClick:[u[2]||(u[2]=V(w=>d("comment"),["stop"])),u[3]||(u[3]=w=>v.value=!v.value)]},[p(o(_),null,{default:f(()=>[p(o(Q))]),_:1}),u[4]||(u[4]=e("span",null,"评论",-1))])])):c("",!0)])]))}}),se=A(te,[["__scopeId","data-v-7d9384ad"]]),ne={class:"container"},le={key:0,class:"users"},ie={key:0},oe=["src","onClick"],ae={key:2},re={key:0},ce={key:1},ue={key:1,class:"input"},de={class:"comments-container"},me=["onClick"],ve={class:"comment-displayName"},pe={key:0},ke={key:1,class:"comment-displayName"},ge={key:0,class:"input"},ye=["placeholder"],he=C({__name:"Review",props:{article:{type:Object,required:!0},isShowInput:Boolean,hasMore:{type:Boolean,required:!0},remainingComments:{type:Number,required:!0},isLoading:{type:Boolean,required:!0},likers:{type:Array,default:()=>[]},comments:{type:Array,default:()=>[]},loadMore:{type:Function,required:!0}},emits:["send-reply"],setup(i,{emit:y}){const a=b(),l=i,v=x=>{const g=x.target;g.style.height="auto",g.style.height=g.scrollHeight+"px"},k=y,d=$(null),t=$(""),m=x=>{d.value===x?d.value=null:(d.value=x,t.value="")},u=()=>{if(!t.value.trim()){a.show("评论内容不能为空","info",2e3);return}k("send-reply",{articleId:l.article.id,parentId:d.value,content:t.value}),t.value="",d.value=null},w=q(),M=D(()=>w.name==="articleDetail");return(x,g)=>(s(),n("div",ne,[i.article.like_count!==0?(s(),n("div",le,[p(o(_),{class:"users-icon"},{default:f(()=>[p(o(H))]),_:1}),(s(!0),n(R,null,B(i.likers,(r,I)=>(s(),n("span",{key:I},[M.value?c("",!0):(s(),n("span",ie,h(r.displayName),1)),M.value?(s(),n("img",{key:1,src:r.avatar,alt:"",style:{width:"25px",height:"25px"},onClick:He=>o(L).push(`/home/${r.username}`)},null,8,oe)):c("",!0),I<i.likers.length-1?(s(),n("span",ae,"，")):c("",!0)]))),128)),i.likers.length!==0?(s(),n("span",re,"...共")):c("",!0),i.article.like_count!==0?(s(),n("span",ce,h(i.article.like_count)+"人喜欢",1)):c("",!0)])):c("",!0),l.isShowInput?(s(),n("div",ue,[S(e("textarea",{"onUpdate:modelValue":g[0]||(g[0]=r=>t.value=r),placeholder:"写下你的评论...",onInput:v},null,544),[[T,t.value]]),e("button",{onClick:u},"发送")])):c("",!0),e("div",de,[(s(!0),n(R,null,B(i.comments,r=>(s(),n("div",{class:"comment",key:r.id},[e("div",{onClick:I=>m(r.id)},[e("span",ve,h(r.user.nickname||r.user.username),1),r.parent_id?(s(),n("span",pe," 回复")):c("",!0),r.parent_id?(s(),n("span",ke,h(r.parent_displayName),1)):c("",!0),g[3]||(g[3]=e("span",null,"：",-1)),e("span",null,h(r.content),1)],8,me),d.value===r.id?(s(),n("div",ge,[S(e("textarea",{"onUpdate:modelValue":g[1]||(g[1]=I=>t.value=I),placeholder:`回复${r.user.nickname||r.user.username}`,onInput:v},null,40,ye),[[T,t.value]]),e("button",{onClick:u},"发送")])):c("",!0)]))),128)),i.hasMore?(s(),n("span",{key:0,class:"load-more",onClick:g[2]||(g[2]=(...r)=>i.loadMore&&i.loadMore(...r))},[e("div",null,[E(h(i.remainingComments)+"条回复 ",1),p(o(_),null,{default:f(()=>[p(o(j))]),_:1})])])):c("",!0)])]))}}),we=A(he,[["__scopeId","data-v-4ecfd637"]]),_e={class:"container"},fe={key:0},Ce=["onClick"],$e=["src"],xe=["src"],Ie=["src"],Le=C({__name:"Media",props:{article:{type:Object,required:!0}},setup(i){const y=b(),a=$(null),l=m=>{a.value=m},v=()=>{a.value=null},k=$(null),d=()=>y.show("播放视频","info",2e3),t=()=>y.show("暂停视频","info",2e3);return z(()=>{k.value&&(k.value.addEventListener("play",d),k.value.addEventListener("pause",t))}),P(()=>{k.value&&(k.value.removeEventListener("play",d),k.value.removeEventListener("pause",t))}),(m,u)=>(s(),n("div",_e,[i.article.article_images.length!==0?(s(),n("ul",fe,[(s(!0),n(R,null,B(i.article.article_images,w=>(s(),n("li",{key:w.id,onClick:M=>l(w.image_url)},[e("img",{src:w.image_url,alt:"文章图片"},null,8,$e)],8,Ce))),128))])):c("",!0),i.article.article_videos.length!==0&&i.article.article_images.length===0?(s(),n("video",{key:1,src:i.article.article_videos[0]?.video_url,ref_key:"videoRef",ref:k,muted:"",playsinline:"",controls:""},null,8,xe)):c("",!0),a.value?(s(),n("div",{key:2,class:"overlay",onClick:v},[e("img",{src:a.value,class:"enlarged",alt:"放大图片"},null,8,Ie)])):c("",!0)]))}}),Ae=A(Le,[["__scopeId","data-v-6cb979ac"]]),Me={key:0,class:"article-item"},Re=["src"],Be={class:"article-context"},be={class:"nickname"},Ne={class:"tags"},Se={class:"media"},Te={class:"review"},De=C({__name:"ArticleItem",props:{article:{},likers:{},comments:{},isShowInput:{type:Boolean},hasMoreComments:{type:Boolean},remainingComments:{},isLoadingComments:{type:Boolean}},emits:["like","comment","send-reply","load-more-comments"],setup(i,{emit:y}){const a=b(),l=i,v=y;async function k(){try{const t=(await J())?.result;console.log(t)}catch(d){console.log("@error",d)}}return(d,t)=>l.article?(s(),n("div",Me,[e("div",{class:"article-avatar",onClick:t[0]||(t[0]=m=>o(L).push(`/home/${l.article.user.username}`))},[e("img",{src:l.article.user?.avatar,alt:"avatar"},null,8,Re)]),e("div",Be,[e("div",be,[e("div",{onClick:t[1]||(t[1]=m=>o(L).push(`/home/${l.article.user.username}`))},[e("p",null,h(l.article.user?.nickname||l.article.user.username),1)]),e("div",Ne,[l.article.is_top?(s(),n("div",{key:0,class:"tag-item",onClick:t[2]||(t[2]=m=>o(a).show("该内容为置顶内容","info",2e3))},[p(o(_),{class:"tag-icon"},{default:f(()=>[p(o(U))]),_:1}),t[8]||(t[8]=e("span",null,"置顶",-1))])):c("",!0),l.article.is_ad?(s(),n("div",{key:1,class:"tag-item",onClick:t[3]||(t[3]=m=>o(a).show("该内容为广告内容","info",2e3))},[p(o(_),{class:"tag-icon"},{default:f(()=>[p(o(G))]),_:1}),t[9]||(t[9]=e("span",null,"广告",-1))])):c("",!0)])]),d.article.content?(s(),n("div",{key:0,class:"main-context",onClick:t[4]||(t[4]=m=>o(L).push(`/article/${l.article.id}`))},[e("p",null,h(l.article.content),1)])):c("",!0),e("div",Se,[p(Ae,{article:l.article},null,8,["article"])]),e("div",{class:"location",onClick:k},[e("p",null,h(l.article.location),1)]),p(se,{article:l.article,onLike:t[5]||(t[5]=m=>v("like",l.article.id)),onComment:t[6]||(t[6]=m=>v("comment"))},null,8,["article"]),e("div",Te,[p(we,{article:l.article,likers:l.likers,comments:l.comments,"is-show-input":l.isShowInput,"has-more":l.hasMoreComments,"is-loading":l.isLoadingComments,"remaining-comments":l.remainingComments,"load-more":()=>v("load-more-comments"),onSendReply:t[7]||(t[7]=m=>v("send-reply",m))},null,8,["article","likers","comments","is-show-input","has-more","is-loading","remaining-comments","load-more"])])])])):c("",!0)}}),je=A(De,[["__scopeId","data-v-91ea85ef"]]);export{je as A};
