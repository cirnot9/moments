import{h as L,j as u,k as t,q as m,u as D,e as I,x as U,y as b,v as h,p as l,s as n,A as v,I as f,m as c,B as k,J as y,K as g,C,t as w,M,_ as T}from"./index-CbEmHIhb.js";import{C as j}from"./ChevronLeft-DJqv1-Do.js";const P={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 320 512"},x=L({name:"ChevronRight",render:function(r,d){return m(),u("svg",P,d[0]||(d[0]=[t("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256L34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z",fill:"currentColor"},null,-1)]))}}),z={class:"container"},R={class:"header"},q={class:"body"},A={class:"body-item-right"},E=["src"],J={key:0,class:"input"},K={class:"body-item-right"},F=["src"],G={key:1,class:"input"},H={class:"body-item-right"},O={key:2,class:"input"},Q={class:"body-item-right"},W={key:3,class:"input"},X={class:"body-item-right"},Y={key:4,class:"input"},Z={class:"body-item-right"},ee={key:5,class:"input"},te={class:"body-item-right"},se={key:6,class:"input"},ae={class:"body-item-right"},oe={key:7,class:"input"},ie=L({__name:"Profile",setup(N){const r=D(),d=I(),s=U({avatar:!1,header_background:!1,role:!1,status:!1,nickname:!1,username:!1,email:!1,brief:!1}),o=U({avatar:b(()=>r.profile?.avatar??"/img/avatar.jpg"),header_background:b(()=>r.profile?.header_background??"/img/header.jpg"),role:b(()=>Number(r.profile?.role)===1?"管理员":"用户"),status:b(()=>Number(r.profile?.status)===1?"正常":"异常"),nickname:b(()=>r.profile?.nickname??"未设置"),username:b(()=>r.profile?.username),email:b(()=>r.profile?.email??"未绑定"),brief:b(()=>r.profile?.brief??"未设置")}),i=U({avatar:"",header_background:"",nickname:"",email:"",brief:""}),V=U({avatar:!1,header_background:!1,nickname:!1,email:!1,brief:!1,status:!1});async function $(p,e){if(V[p])return;if(e===o[p]){d.show("内容未作修改","info",2e3);return}const a={[p]:e},_=d.show("正在修改中","loading");try{V[p]=!0,await M(a),await r.fetchUserProfile(),d.update(_,{text:"更新成功",type:"success",duration:2e3}),p in s&&(s[p]=!1)}catch(B){console.error("更新信息失败，请稍后重试",B),d.update(_,{text:"更新信息失败，请稍后重试",type:"error",duration:2e3})}finally{V[p]=!1,setTimeout(()=>{d.close(_)},2e3)}}r.token||(d.show("请先登录账户","info",2e3),r.handleLogout(),h.replace("/"));function S(){r.handleLogout(),d.show("已退出登录","success",2e3),h.replace("/")}return(p,e)=>(m(),u("div",z,[t("div",R,[t("div",{id:"back",onClick:e[0]||(e[0]=a=>l(h).back())},[n(l(f),null,{default:v(()=>[n(l(j))]),_:1})]),e[22]||(e[22]=t("div",null,"用户资料",-1))]),t("div",q,[t("div",{class:"body-item",onClick:e[1]||(e[1]=a=>{i.avatar=o.avatar,s.avatar=!s.avatar})},[e[23]||(e[23]=t("div",{class:"body-item-left"},"头像",-1)),t("div",A,[t("img",{src:o.avatar,alt:"avatar",style:{width:"35px"}},null,8,E),n(l(f),{class:k(["icon",{"rotate-icon":s.avatar}])},{default:v(()=>[n(l(x))]),_:1},8,["class"])])]),s.avatar?(m(),u("div",J,[y(t("input",{type:"text",placeholder:"请输入 新头像url","onUpdate:modelValue":e[2]||(e[2]=a=>i.avatar=a)},null,512),[[g,i.avatar]]),t("button",{onClick:e[3]||(e[3]=a=>$("avatar",i.avatar))},"更新")])):c("",!0),t("div",{class:"body-item",onClick:e[4]||(e[4]=a=>{i.header_background=o.header_background,s.header_background=!s.header_background})},[e[24]||(e[24]=t("div",{class:"body-item-left"},"背景",-1)),t("div",K,[t("img",{src:o.header_background,alt:"不支持视频",style:{width:"60px"}},null,8,F),n(l(f),{class:k(["icon",{"rotate-icon":s.avatar}])},{default:v(()=>[n(l(x))]),_:1},8,["class"])])]),s.header_background?(m(),u("div",G,[y(t("input",{type:"text",placeholder:"请输入 新背景url","onUpdate:modelValue":e[5]||(e[5]=a=>i.header_background=a)},null,512),[[g,i.header_background]]),t("button",{onClick:e[6]||(e[6]=a=>$("header_background",i.header_background))},"更新")])):c("",!0),t("div",{class:"body-item",onClick:e[7]||(e[7]=a=>s.role=!s.role)},[e[25]||(e[25]=t("div",{class:"body-item-left"},"角色",-1)),t("div",H,[C(w(o.role)+" ",1),n(l(f),{class:k(["icon",{"rotate-icon":s.role}])},{default:v(()=>[n(l(x))]),_:1},8,["class"])])]),s.role?(m(),u("div",O,[y(t("input",{type:"text",placeholder:"请输入 角色",readonly:"","onUpdate:modelValue":e[8]||(e[8]=a=>o.username=a),style:{color:"#00000098"}},null,512),[[g,o.username]]),e[26]||(e[26]=t("button",{style:{background:"#00000098"}},"不可更改",-1))])):c("",!0),t("div",{class:"body-item",onClick:e[9]||(e[9]=a=>s.status=!s.status)},[e[27]||(e[27]=t("div",{class:"body-item-left"},"状态",-1)),t("div",Q,[C(w(o.status)+" ",1),n(l(f),{class:k(["icon",{"rotate-icon":s.status}])},{default:v(()=>[n(l(x))]),_:1},8,["class"])])]),s.status?(m(),u("div",W,[y(t("input",{type:"text",placeholder:"请输入 状态码",readonly:"","onUpdate:modelValue":e[10]||(e[10]=a=>o.status=a),style:{color:"#00000098"}},null,512),[[g,o.status]]),e[28]||(e[28]=t("button",{style:{background:"#00000098"}},"不可更改",-1))])):c("",!0),t("div",{class:"body-item",onClick:e[11]||(e[11]=a=>{i.nickname=o.nickname,s.nickname=!s.nickname})},[e[29]||(e[29]=t("div",{class:"body-item-left"},"昵称",-1)),t("div",X,[C(w(o.nickname)+" ",1),n(l(f),{class:k(["icon",{"rotate-icon":s.nickname}])},{default:v(()=>[n(l(x))]),_:1},8,["class"])])]),s.nickname?(m(),u("div",Y,[y(t("input",{type:"text",placeholder:"请输入 新昵称","onUpdate:modelValue":e[12]||(e[12]=a=>i.nickname=a)},null,512),[[g,i.nickname]]),t("button",{onClick:e[13]||(e[13]=a=>$("nickname",i.nickname))},"更新")])):c("",!0),t("div",{class:"body-item",onClick:e[14]||(e[14]=a=>s.username=!s.username)},[e[30]||(e[30]=t("div",{class:"body-item-left"},"账号",-1)),t("div",Z,[C(w(o.username)+" ",1),n(l(f),{class:k(["icon",{"rotate-icon":s.username}])},{default:v(()=>[n(l(x))]),_:1},8,["class"])])]),s.username?(m(),u("div",ee,[y(t("input",{type:"text",placeholder:"请输入 用户名",readonly:"","onUpdate:modelValue":e[15]||(e[15]=a=>o.username=a),style:{color:"#00000098"}},null,512),[[g,o.username]]),e[31]||(e[31]=t("button",{style:{background:"#00000098"}},"不可更改",-1))])):c("",!0),t("div",{class:"body-item",onClick:e[16]||(e[16]=a=>{i.email=o.email,s.email=!s.email})},[e[32]||(e[32]=t("div",{class:"body-item-left"},"邮箱",-1)),t("div",te,[C(w(o.email)+" ",1),n(l(f),{class:k(["icon",{"rotate-icon":s.email}])},{default:v(()=>[n(l(x))]),_:1},8,["class"])])]),s.email?(m(),u("div",se,[y(t("input",{type:"text",placeholder:"请输入 邮箱","onUpdate:modelValue":e[17]||(e[17]=a=>i.email=a)},null,512),[[g,i.email]]),t("button",{onClick:e[18]||(e[18]=a=>$("email",i.email))},"更新")])):c("",!0),t("div",{class:"body-item",onClick:e[19]||(e[19]=a=>{i.brief=o.brief,s.brief=!s.brief})},[e[33]||(e[33]=t("div",{class:"body-item-left"},"签名",-1)),t("div",ae,[C(w(o.brief)+" ",1),n(l(f),{class:k(["icon",{"rotate-icon":s.brief}])},{default:v(()=>[n(l(x))]),_:1},8,["class"])])]),s.brief?(m(),u("div",oe,[y(t("input",{type:"text",placeholder:"请输入 签名","onUpdate:modelValue":e[20]||(e[20]=a=>i.brief=a)},null,512),[[g,i.brief]]),t("button",{onClick:e[21]||(e[21]=a=>$("brief",i.brief))},"更新")])):c("",!0),t("div",{class:"body-logout",onClick:S},e[34]||(e[34]=[t("div",null,"退出登录",-1)]))])]))}}),re=T(ie,[["__scopeId","data-v-94acdc07"]]);export{re as default};
